<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPL Fantasy League</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>IPL Fantasy League</h1>
        <p>Welcome to the IPL Fantasy League! Select your team and track the points.</p>
    </header>

    <section id="team-selection">
        <h2>Select Your Team</h2>
        <form id="teamForm">
            <label for="teamName">Team Name: </label>
            <input type="text" id="teamName" name="teamName" required>
            <br>

            <!-- Form for players -->
            <h3>Capped Players (Max 5)</h3>
            <div>
                <label for="player1">Player 1: </label>
                <input type="text" id="player1" name="player1" required>
                <label for="player2">Player 2: </label>
                <input type="text" id="player2" name="player2" required>
                <label for="player3">Player 3: </label>
                <input type="text" id="player3" name="player3" required>
                <label for="player4">Player 4: </label>
                <input type="text" id="player4" name="player4" required>
                <label for="player5">Player 5: </label>
                <input type="text" id="player5" name="player5" required>
            </div>
            
            <button type="submit">Submit Team</button>
        </form>
    </section>

    <section id="submitted-teams">
        <h2>Submitted Teams</h2>
        <ul id="teamsList"></ul>
    </section>

    <script type="module">
        // Import Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-firestore.js";

        // Firebase Configuration (updated with your project details)
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID",
            measurementId: "YOUR_MEASUREMENT_ID"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Handle Form Submission
        document.getElementById('teamForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const teamName = document.getElementById('teamName').value;
            const players = [
                document.getElementById('player1').value,
                document.getElementById('player2').value,
                document.getElementById('player3').value,
                document.getElementById('player4').value,
                document.getElementById('player5').value
            ];

            try {
                // Save team to Firestore with initial points set to 0
                await addDoc(collection(db, "teams"), {
                    teamName: teamName,
                    players: players,
                    points: 0,
                    timestamp: new Date()
                });

                alert('Team successfully submitted!');
                document.getElementById('teamForm').reset(); // Clear form after submission
                loadTeams(); // Refresh teams list
            } catch (error) {
                console.error("Error adding document: ", error);
                alert("Error submitting team. Try again.");
            }
        });

        // Function to Load Submitted Teams from Firestore
        async function loadTeams() {
            const teamsList = document.getElementById("teamsList");
            teamsList.innerHTML = ""; // Clear existing list

            const querySnapshot = await getDocs(collection(db, "teams"));
            querySnapshot.forEach((doc) => {
                const team = doc.data();
                const listItem = document.createElement("li");
                listItem.textContent = `${team.teamName}: Players - ${team.players.join(", ")} - Points: ${team.points}`;
                teamsList.appendChild(listItem);
            });
        }

        // Load teams when the page loads
        loadTeams();
    </script>
</body>
</html>
